<%= render "components/restaurantbanner" %>

<div class="meal-wrapper">
  <div class="meal-container">
    <div class="row">
      <div class="col-xs-12">
      <div class = " col-xs-12 col-sm-7 col-lg-7 ">
        <div class = "card-meal">
          <h2> Voici le plat du jour ! </h2>
          <div class="img-meal img-responsive" style="background: url('<%=@meal.photo%>'); background-position: center; background-size: cover; background-repeat: no-repeat; height: 300px; width: 450px;">
          </div>
        </div>
      </div>
      <div class ="col-xs-offset-0 col-xs-12 col-sm-offset-0 col-sm-5 col-lg-5">
        <div class = "description">
          <h3><%= @meal.name %></h3>
          <hr>
          <h4> Description</h4>
          <p><%= @meal.description %></p>
          <p><a class="btn btn-primary btn-lg" href="#order" role="button">Choisir ce plat</a></p>
        </div>
        </div>
      </div>
      </div>
  </div>
</div>
<div class="map-wrapper">
  <div class="map-container">
    <div class="row">
      <div class="col-xs-12">
        <div id="map" style="height: 300px;"></div>
                  <% content_for(:after_js) do %>
                    <%= javascript_tag do %>
                      var handler = Gmaps.build('Google');
                      handler.buildMap({ internal: { id: 'map' } }, function() {
                        markers = handler.addMarkers(<%= raw @hash.to_json %>);
                        handler.bounds.extendWith(markers);
                        handler.fitMapToBounds();
                        if (markers.length == 0) {
                          handler.getMap().setZoom(2);
                        } else if (markers.length == 1) {
                          handler.getMap().setZoom(14);
                        }
                      });
                  <% end %>
                <% end %>
        </div>
      </div>
    </div>
  </div>
<div class="meal-wrapper" id= "order">
  <div class="meal-container">
    <div class="row">
      <div class="col-xs-12">
          <% if @has_order %>
          <div class= "meal-card">
            <div class = "col-xs-12 col-md-offset-0 col-md-5">
              <div id="already" class = "pick-card text-center">
              <h2>Vous avez déjà fait votre choix</h2>
                <div class = "pick-card-description">
                  <p> Si vous souhaitez changer de plat, veuillez annuler votre commande actuelle dans la rubrique "Mon compte", puis commander de nouveau.</p>
                </div>
              </div>
            </div>
          </div>
            <% else %>
          <div class= "meal-card">
            <div class = "col-xs-12 col-md-offset-0 col-md-5">
              <div class = "pick-card text-center">
                <h2> PICK-UP </h2>
                <div class = "pick-card-description">
                  <p> Choisissez votre créneau : </p>
                  <%= render "orders/new" %>
                </div>
              </div>
            </div>
          </div>
            <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
